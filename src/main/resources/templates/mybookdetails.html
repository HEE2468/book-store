<!DOCTYPE html>
<html>
<head>
    <title>商品详情</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link type="text/css" rel="stylesheet" href="css/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="css/style.css">
    <link type="text/css" rel="stylesheet" href="css/flexslider.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.flexslider.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="layer/layer.js"></script>
    <script type="text/javascript" src="js/cart.js"></script>
    <link href="css/index/style.css" type="text/css" rel="stylesheet"/>
    <link href="layui/css/layui.css" type="text/css" rel="stylesheet"/>
    <script src="layui/layui.js" type="text/javascript"></script>
</head>
<style>
    .paginate{
        position: relative;
        float: left;
        width: 30%;
        height: 40%;
        left:40%;
        display:inline-block !important;
    }

    .paginate .layui-laypage .layui-laypage-curr .layui-laypage-em{
        background-color: #D70010;
    }

    .paginate .layui-laypage-btn{
        background-color: #D70010;
        color: #FFFFFF;
    }

    .paginate>.layui-laypage>a:hover{
        color: #fff;
        background-color: #D70010;
        border-color: #D70010;
    }

</style>
<body>

<!-- 横幅 topbar -->
<div class="site-topbar-v">
    <div class="container-v">
        <div class="container-topbar-title-v">
            <a class="title-content" style="color: #ffffff;font-size: 12px">闲置书籍转借云服务平台</a>
        </div>

        <div class="container-topbar-userInfo">
            <img src="images/index/u335.svg" style="width: 22px;height: 22px">
            <div id="noLogin" class="userInfo-and">
                <a class="login-v" href="login.html" style="color:#ffffff;font-size: 12px">登录</a>
                <span class="split-content-v" style="color:#ffffff;font-size: 12px">|</span>
                <a class="register-v" href="register.html" style="color:#ffffff;font-size: 12px">注册</a>
            </div>
            <div id="hasLogin" class="userInfo-and userInfo-has-login" style="display: none">
                <li class="show_list">
                    <span id="loginName" style="margin-left: -10px;color: #ffffff">shenwenwen</span>
                    <ul class="move_list">
                        <li id="center-nav">个人中心</li>
                        <li id="order-nav">我的订单</li>
                        <li id="out-nav">退出</li>
                    </ul>
                </li>
            </div>
        </div>

        <div class="container-topbar-buttons">
            <img src="images/index/topbar_btns.png" style="width: 30px;height: 25px">
        </div>

        <div class="container-topbar-messages">
            <img src="images/index/systeminfos.png" style="width: 25px;height: 25px">
            <a style="color:#ffffff;font-size: 12px;width: 25px;height: 25px;border-radius: 20px;background-color: #ff0000">20</a>
        </div>

        <!--购物车-->
        <div class="container-topbar-car">
            <a class="shopping_car" href="javascript:enterMyCar();">
                <img src="images/index/car.png" style="width: 25px;height: 25px">
                <span id="carNumber" style="color:#ffffff;font-size: 12px">购物车（0）</span>
            </a>
        </div>
    </div>
</div>

<!-- 首页导航栏 -->
<div class="site-header">

    <div class="site-logo">
        <img class="header-logo" src="images/logo.png">
    </div>

    <div class="header-nav-v">
        <ul class="nav-list-v">
            <li class="li-item-index" id="item-index-nav">
                <a style="color: #7F7F7F" href="index.html">首页</a>
            </li>
            <li class="li-item-all">
                <a class="item-all" href="" style="color: #7F7F7F">全部图书</a>
            </li>
            <li class="li-item-new">
                <a class="item-new" href="" style="color: #7F7F7F">最新上架</a>
            </li>
            <li class="li-item-hot">
                <a class="item-hot" href="" style="color: #7F7F7F">最热畅销</a>
            </li>
            <li class="li-item-good">
                <a class="item-good" href="" style="color: #7F7F7F">最佳推荐</a>
            </li>
            <li class="li-item-about">
                <a class="item-about" href="" style="color: #7F7F7F">关于我们</a>
            </li>
            <li class="li-item-admin">
                <a class="item-admin" href="admin_login.html" style="color: #7F7F7F">管理员登录</a>
            </li>
        </ul>
    </div>

    <div class="header-search" >
        <input id="searchNavValue" type="text" placeholder="请输入..." name="" id="" value="" />
        <button id="search-nav"><i>搜索</i></button>
    </div>
</div>

<div id="main-page" style="margin-top: 100px">
    <!--//single-page-->
    <div class="single">
        <div class="container">
            <div class="single-grids" >
                <div class="col-md-4 single-grid">
                    <img :src="info.image" data-imagezoom="true" class="img-responsive">
                </div>
                <div class="col-md-4 single-grid simpleCart_shelfItem">
                    <h3>{{info.bookName}}</h3>
                    <div class="tag">
                        <p>分类 : <a href="goods.action?typeid=5">{{info.bookCategory.category}} &amp&amp {{info.bookClass.classes}}</a></p>
                    </div>
                    <p>{{info.bookDescription}}</p>
                    <div class="galry">
                        <div class="prices">
                            <h5 class="item_price">{{info.price}}</h5>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="btn_form">
                        <a href="javascript:;" class="add-cart item_add" @click="buyBook(info.bookDetailsId)">加入购物车</a>
                    </div>
                </div>
                <div class="col-md-4 single-grid1">
                    <!-- <h2>商品分类</h2> -->
                    <ul>

                        <li><a href="#" onclick="jumpBookClass(1)">人文社科</a></li>

                        <li><a href="#" onclick="jumpBookClass(2)">经管综合</a></li>

                        <li><a href="#" onclick="jumpBookClass(3)">励志成功</a></li>

                        <li><a href="#" onclick="jumpBookClass(4)">生活美食</a></li>

                        <li><a href="#" onclick="jumpBookClass(5)">计算机</a></li>

                        <li><a href="#" onclick="jumpBookClass(6)">艺术</a></li>

                        <li><a href="#" onclick="jumpBookClass(7)">科技</a></li>

                        <li><a href="#" onclick="jumpBookClass(8)">电子书</a></li>

                        <li><a href="#" onclick="jumpBookClass(9)">杂志/期刊</a></li>

                    </ul>
                </div>
                <div class="clearfix"> </div>
            </div>
        </div>
    </div>
</div>


<!-- 搜索分页 -->
<div class="search-page" id="search-page"></div>
<div class="paginate" id="pagination-layui"></div>

<!--footer-->
<div class="footer">
    <div class="container">
        <div class="text-center">
            <p>中信银行股份有限公司版权所有 Copyright © CITIC Bank All rights reserved</p>
        </div>
    </div>
</div>
<!--//footer-->


</body>
<script src="js/jquery-1.12.4.min.js" type="text/javascript"></script>
<script src="js/nav.js" type="text/javascript"></script>
<script src="js/vue/vue.min.js" type="text/javascript"></script>
<script src="js/axios.min.js" type="text/javascript"></script>
<script src="js/car.js" type="text/javascript"></script>
<script type="text/javascript">
    function enterMyCar() {
        if(window.sessionStorage.getItem("userId")!=="null"){
            window.location.href = "mycar.html";
        }
    }
</script>
<script type="text/javascript">
    new Vue({
        el:'.single',
        data:{
            bookName:'',
            bookDescription:'',
            price:0,
            bookDetailsId:'',
            info:{
                bookCategory:{
                    category:''
                },
                bookClass:{
                    classes:''
                }
            }
        },
        mounted(){
            let argsIndex = window.location.href.split("?bookDetailsId=");
            let bookDetailsId = argsIndex[1];
            axios.post('details/findBooksById',{bookDetailsId: bookDetailsId})
                .then(response => {
                    this.info = response.data;
                })
                .catch(function (error) { // 请求失败处理
                    console.log(error);
                });
        },
        methods:{
            buyBook:function (bookDetailsId) {
                if(window.sessionStorage.getItem("userId")!=null){
                    axios.post('car/insertBuyBook',{
                        bookDetailsId: bookDetailsId,
                        userId:window.sessionStorage.getItem("userId")
                    })
                        .then(response => {
                            //this.info = response.data;
                            if(response.data.code === -1){
                                alert(response.data.msg);
                            }else{
                                window.location.reload();
                            }

                        })
                        .catch(function (error) { // 请求失败处理
                            console.log(error);
                        });
                }else {
                    alert("请先登录!")
                }

            },

        }

    });

    function jumpBookClass(bookClassId) {
        window.sessionStorage.setItem("bookClassId",bookClassId);
        window.location.href = "mybookclass.html";
    }

</script>


</html>